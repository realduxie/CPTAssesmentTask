{% extends 'layout.html' %}

{% block title %}Browse Restaurants - Table Finder{% endblock %}

{% block content %}
<div class="page-header">
    <h1>
        BROWSE <span class="accent">RESTAURANTS</span>
    </h1>
    <p>Discover amazing dining experiences across the city</p>
</div>

<form method="GET" action="{{ url_for('browse') }}" id="filterForm">
<div style="background: white; border-radius: 1.5rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); padding: 2rem; margin-bottom: 3rem;">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
        <div style="position: relative;">
            <svg style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: #9ca3af; width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/>
            </svg>
            <input 
                type="text" 
                name="search"
                placeholder="Search restaurants..."
                value="{{ search }}"
                style="width: 100%; padding: 0.875rem 1rem 0.875rem 3rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; font-size: 1rem; outline: none;"
                onfocus="this.style.borderColor='#4ecdc4'"
                onblur="this.style.borderColor='#e5e7eb'"
            />
        </div>

        <select name="category" style="width: 100%; padding: 0.875rem 1rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; font-size: 1rem; outline: none; background: white; font-weight: 600;">
            <option value="">All Cuisines</option>
            {% for cat in categories %}
            <option value="{{ cat.Category_Name }}" {% if category == cat.Category_Name %}selected{% endif %}>{{ cat.Category_Name }}</option>
            {% endfor %}
        </select>

        <select name="sort" style="width: 100%; padding: 0.875rem 1rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; font-size: 1rem; outline: none; background: white; font-weight: 600;">
            <option value="name" {% if sort == 'name' %}selected{% endif %}>Sort by Name</option>
            <option value="capacity-high" {% if sort == 'capacity-high' %}selected{% endif %}>Capacity: High to Low</option>
            <option value="capacity-low" {% if sort == 'capacity-low' %}selected{% endif %}>Capacity: Low to High</option>
        </select>
    </div>
    
    <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 1rem; border-top: 2px solid #f3f4f6;">
        <div style="color: #6b7280; font-weight: 600;">
            Showing {{ restaurants|length }} of {{ total }} restaurants
        </div>
        <div style="display: flex; gap: 0.75rem;">
            <button 
                type="submit"
                style="background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 100%); color: white; padding: 0.75rem 2rem; border-radius: 9999px; border: none; font-weight: 900; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);"
                onmouseover="this.style.transform='scale(1.05)'"
                onmouseout="this.style.transform='scale(1)'"
            >
                Apply Filters
            </button>
            <a 
                href="{{ url_for('browse') }}"
                style="background: white; color: #6b7280; padding: 0.75rem 1.5rem; border-radius: 9999px; border: 2px solid #e5e7eb; font-weight: 900; cursor: pointer; transition: all 0.2s ease; text-decoration: none; display: inline-block;"
                onmouseover="this.style.borderColor='#ff6b6b'; this.style.color='#ff6b6b'"
                onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#6b7280'"
            >
                Clear
            </a>
        </div>
    </div>
</div>
</form>

<div class="restaurants-grid">
    {% for restaurant in restaurants %}
    <div class="restaurant-card" style="position: relative; overflow: hidden;">
        <div style="position: absolute; top: 1rem; right: 1rem; background: #4ecdc4; color: white; padding: 0.5rem 1rem; border-radius: 9999px; font-weight: 900; font-size: 0.875rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); z-index: 10;">
            {% if restaurant.Category_Name %}
                {{ restaurant.Category_Name }}
            {% else %}
                Restaurant
            {% endif %}
        </div>
        
        <div style="height: 12rem; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(78, 205, 196, 0.1) 100%); border-radius: 1rem; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: center; font-size: 5rem;">
            {% if restaurant.Category_Name == 'Italian' %}
                ğŸ
            {% elif restaurant.Category_Name == 'Japanese' %}
                ğŸ±
            {% elif restaurant.Category_Name == 'Modern Australian' %}
                ğŸ¦˜
            {% else %}
                ğŸ½ï¸
            {% endif %}
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
            <div style="flex: 1;">
                <h3 style="margin-bottom: 0.5rem;">{{ restaurant.Restaurant_Name }}</h3>
                <div style="display: flex; align-items: center; gap: 0.25rem; margin-bottom: 0.75rem;">
                    <svg style="width: 1rem; height: 1rem; color: #fbbf24; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <svg style="width: 1rem; height: 1rem; color: #fbbf24; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <svg style="width: 1rem; height: 1rem; color: #fbbf24; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <svg style="width: 1rem; height: 1rem; color: #fbbf24; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <svg style="width: 1rem; height: 1rem; color: #e5e7eb; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <span style="font-weight: 900; color: #2c3e50; margin-left: 0.25rem; font-size: 0.875rem;">4.5</span>
                </div>
            </div>
        </div>
        
        <p style="margin-bottom: 0.75rem; color: #6b7280; font-size: 0.875rem;">
            <strong style="color: #2c3e50;">ğŸ“</strong> {{ restaurant.Address }}
        </p>
        
        <p style="margin-bottom: 0.75rem; color: #6b7280; font-size: 0.875rem;">
            <strong style="color: #2c3e50;">ğŸ“</strong> {{ restaurant.Phone_Number }}
        </p>
        
        <p style="margin-bottom: 1rem; color: #6b7280; font-size: 0.875rem;">
            <strong style="color: #2c3e50;">ğŸ•</strong> {{ restaurant.Opening_Time }} - {{ restaurant.Closing_Time }}
        </p>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding: 0.75rem; background: rgba(78, 205, 196, 0.1); border-radius: 0.75rem;">
            <span style="color: #10b981; font-weight: 900; font-size: 0.875rem;">âœ“ Tables Available</span>
            <span style="color: #6b7280; font-weight: 600; font-size: 0.875rem;">Seats {{ restaurant.Capacity }}</span>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <a 
                href="{{ url_for('booking') }}" 
                style="background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 100%); color: white; padding: 0.875rem; border-radius: 0.75rem; text-align: center; text-decoration: none; font-weight: 900; font-size: 0.875rem; transition: all 0.2s ease; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);"
                onmouseover="this.style.transform='scale(1.05)'"
                onmouseout="this.style.transform='scale(1)'"
            >
                BOOK NOW
            </a>
            <button 
                style="background: white; color: #4ecdc4; border: 2px solid #4ecdc4; padding: 0.875rem; border-radius: 0.75rem; font-weight: 900; font-size: 0.875rem; cursor: pointer; transition: all 0.2s ease;"
                onmouseover="this.style.background='#4ecdc4'; this.style.color='white'"
                onmouseout="this.style.background='white'; this.style.color='#4ecdc4'"
            >
                VIEW MENU
            </button>
        </div>
    </div>
    {% endfor %}
    
    {% if not restaurants %}
    <div class="no-results" style="grid-column: 1 / -1;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ”</div>
        <h3 style="font-size: 1.875rem; font-weight: 900; color: #2c3e50; margin-bottom: 0.5rem;">No Restaurants Found</h3>
        <p>Try adjusting your filters or search terms.</p>
        <a href="{{ url_for('browse') }}" class="btn btn-primary" style="margin-top: 1.5rem; display: inline-block;">Clear Filters</a>
    </div>
    {% endif %}
</div>

{% if has_more %}
<div style="text-align: center; padding: 3rem 0;">
    <a 
        href="{{ url_for('browse', search=search, category=category, sort=sort, page=page+1) }}"
        style="display: inline-block; background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 100%); color: white; padding: 1.25rem 3rem; border-radius: 9999px; border: none; font-size: 1.25rem; font-weight: 900; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); text-decoration: none;"
        onmouseover="this.style.transform='scale(1.05)'"
        onmouseout="this.style.transform='scale(1)'"
    >
        LOAD MORE RESTAURANTS
    </a>
</div>
{% endif %}

<style>
@media (max-width: 768px) {
    div[style*="grid-template-columns: repeat(auto-fit"] {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}